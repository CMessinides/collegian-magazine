{{ define "head-title" }}{{ .Site.Data.branding.site_name | default .Site.Title }}{{ end }}

{{ define "head-description" }}{{ .Site.Data.branding.description | printf "%.150s" }}{{ end }}

{{ define "head-social" }}

{{ end }}

{{ define "hero" }}
  {{ $featured := first 4 (where (where .Site.Pages "Section" "article") "Params.featured" true) }}

  {{ if $featured }}
    {{ $first := index $featured 0 }}

    <div class="hero is-light">
      <div class="hero-head">
        <div class="container hero__banner" {{ with $first.Params.cover_image }}style="background-image:url({{ . | safeCSS }});"{{ end }}>
          <div class="hero__fade is-overlay"></div>
        </div>
      </div>
      <div class="hero-footer">
        <h1 class="hide">Featured</h1>
        {{ $first.Render "hero-insert" }}

        {{ if gt (len $featured) 1 }}
          <aside class="container">
            <h2 class="hide">More Featured</h2>
            <ul class="list grid">
              {{ range (after 1 $featured) }}
                <li class="md-wid-4 wid-6">
                  {{ with .Params.categories }}
                    <p>{{ index . 0 }}</p>
                  {{ end }}
                  <h3>{{ .Title }}</h3>
                  <p>{{ .Date | dateFormat "Jan 2, 2006" }}</p>
                </li>
              {{ end }}
            </ul>
          </aside>
        {{ end }}
      </div>

    </div>

  {{ end }}

{{ end }}

{{ define "content" }}
    <section class="">
      <h1 class="h4">In the Latest Issue</h1>
      <ul class="list">
        {{ range first 5 (where (where .Site.Pages "Section" "article") "Params.featured" "ne" "true") }}
        <li>{{ .Render "card-beta" }}</li>
        {{ end }}
      </ul>
      <a href="{{ "/article/" | absURL }}">All articles</a>
    </section>

    {{ $first_announce := index (where .Site.Pages "Section" "announcement") 0 }}
    {{ if $first_announce }}
    <section class="gtrs-1-a md-gtrs-2-a section--bold">
      <h1 class="h4">Announcement</h1>
      {{ $first_announce.Render "card-beta" }}
      <a href="{{ "/announcement/" | absURL }}">More announcements</a>
    </section>
    {{ end }}

    <section class="gtrs-1-a md-gtrs-2-a">
      <h1 class="h4">Categories</h1>
      <ul class="list">
        {{ range $name, $category := .Site.Taxonomies.categories }}
        <li class="wid-6">
          <h2 class="h2">{{ $name }}</h2>
          <ul class="list">
            {{ range first 3 $category.Pages}}
            <li>{{ .Render "card-gamma" }}</li>
            {{ end }}
          </ul>
          <a href="{{ $name | urlize | printf "/categories/%s/" | absURL }}">More in {{ $name }}</a>
        </li>
        {{ end }}
      </ul>
    </section>
{{ end }}
