{{ define "head-title" }}{{ .Site.Data.branding.site_name | default .Site.Title }}{{ end }}

{{ define "head-description" }}{{ .Site.Data.branding.description | printf "%.150s" }}{{ end }}

{{ define "head-social" }}

{{ end }}

{{ define "hero" }}
  {{ $featured := first 4 (where (where .Site.Pages "Section" "article") "Params.featured" true) }}

  {{ if $featured }}
    {{ $first := index $featured 0 }}

    <div class="hero is-light">
        <div class="hero-head">
          <div class="hero__banner container" {{ with $first.Params.cover_image }}style="background-image:url({{ . | safeCSS }});"{{ end }}>
            <div class="hero__fade is-overlay"></div>
            <h1 class="is-hidden">Featured</h1>
            {{ $first.Render "hero-insert" }}
          </div>
        </div>
        {{ if gt (len $featured) 1 }}
        <aside class="hero-foot">
            <h2 class="is-hidden">More Featured</h2>
            <ul class="container level">
              {{ range (after 1 $featured) }}
              <li class="level-item has-text-centered">
                <article class="tile is-vertical">
                  <h3 class="title is-4">{{ .Title }}</h3>
                  <p class="is-5">{{ .Date | dateFormat "Jan 2, 2006" }}</p>
                  {{ with .Params.categories }}
                  <p class="is-6">{{ index . 0 }}</p>
                  {{ end }}
                </article>
              </li>
              {{ end }}
            </ul>
        </aside>
        {{ end }}

    </div>

  {{ end }}

{{ end }}

{{ define "content" }}
    <section class="">
      <h1 class="h4">In the Latest Issue</h1>
      <ul class="list">
        {{ range first 5 (where (where .Site.Pages "Section" "article") "Params.featured" "ne" "true") }}
        <li>{{ .Render "card-beta" }}</li>
        {{ end }}
      </ul>
      <a href="{{ "/article/" | absURL }}">All articles</a>
    </section>

    {{ $first_announce := index (where .Site.Pages "Section" "announcement") 0 }}
    {{ if $first_announce }}
    <section class="gtrs-1-a md-gtrs-2-a section--bold">
      <h1 class="h4">Announcement</h1>
      {{ $first_announce.Render "card-beta" }}
      <a href="{{ "/announcement/" | absURL }}">More announcements</a>
    </section>
    {{ end }}

    <section class="gtrs-1-a md-gtrs-2-a">
      <h1 class="h4">Categories</h1>
      <ul class="list">
        {{ range $name, $category := .Site.Taxonomies.categories }}
        <li class="wid-6">
          <h2 class="h2">{{ $name }}</h2>
          <ul class="list">
            {{ range first 3 $category.Pages}}
            <li>{{ .Render "card-gamma" }}</li>
            {{ end }}
          </ul>
          <a href="{{ $name | urlize | printf "/categories/%s/" | absURL }}">More in {{ $name }}</a>
        </li>
        {{ end }}
      </ul>
    </section>
{{ end }}
